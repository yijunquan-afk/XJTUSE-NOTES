[TOC]

# 2.2 求解递归(必考重点)
![在这里插入图片描述](https://raw.githubusercontent.com/yijunquan-afk/img-bed-1/main/img13/1695718785.png)

一个分治法将规模为n的问题分成k个规模为n／m的子问题去解。设分解阀值n0=1，且adhoc解规模为1的问题耗费1个单位时间。再设将原问题分解为k个子问题以及用merge将k个子问题的解合并为原问题的解需用f(n)个单位时间。用T(n)表示该分治法解规模为|P|=n的问题所需的计算时间，则有：
![在这里插入图片描述](https://raw.githubusercontent.com/yijunquan-afk/img-bed-1/main/img13/1695718787.png)

如何求这类分治问题的时间复杂度？有三种方法，其中主要介绍递归树法和主方法

## 1、代入法

猜测一个界，然后用数学归纳法证明解是正确的；

## 2、递归树法（最普适）

利用递归树求解，时间复杂度包含两部分，一部分是分解的时间消耗（树的纵向），一部分是合并的时间消耗（树的横向）。

**举例说明**：求$T(n) = T(n/4) + T(n/2) + n^2$的一个渐进上界

递归过程如下：
![在这里插入图片描述](https://raw.githubusercontent.com/yijunquan-afk/img-bed-1/main/img13/1695718788.png)

由于该递归表达式分为两项，所以算树的高度时，我们只需要看n/2的分解，由$\frac{n}{2^h}=1$可得递归树的层数为$h=\log_{2}n$， 分解的时间消耗为$t_{1}\le n^2(1+\frac{5}{16}+\frac{25}{256}+...+(\frac{5}{16})^{{\log_{2}n}-1}=\frac{(\frac{5}{16})^{\log_{2}n}-1}{\frac{5}{16}-1}<\frac{16}{11}n^2$，则有$t_{1}=O(n^2)$

叶子节点的个数小于$2^{\log_2{n}}=n$个，故合并的时间消耗为 $t_{2}=O(n)$

所以$T(n)=t_{1}+t_{2}=O(n^2)$

## 3、主方法

令$a\ge1\text{和}b>1$是常数，$f(n)$是一个函数，$T(n)$是定义在非负整数上的递归式：
$$
T(n)=aT(\frac{n}{b})+f(n)
$$
$T(n)$有如下渐进界：

:one: 若对某个常数 $\epsilon >0$有$f(n)=O(n^{\log_{b}a-\epsilon})$，则 $T(n)=\Theta(n^{\log_{b}a})$

:two: 若$f(n)=\Theta(n^{\log_{b}a})$，则$T(n)=\Theta(n^{\log_{b}a}\lg n)$

:three: 若对某个常数 $\epsilon >0$有$f(n)=\Omega(n^{\log_{b}a+\epsilon})$，且对某个常数$c<1$和足够大的*n*有$af(n/b)\le cf(n)$则 $T(n)=\Theta(f(n))$

<font color="red">**注意点**</font>

> 在第一种情况中，不是$f(n)$小于$n^{\log_{b}a}$就够了，而是要多项式意义上的小于，也就是说，$f(n)$必须渐进小于$n^{\log_{b}a}$，<font color="red">要相差一个因子$n^{\epsilon}$</font>
>
> 其中$\epsilon$是大于0的常数。
>
> 在第三种情况中，不是$f(n)$大于$n^{\log_{b}a}$就够了，而是要多项式意义上的大于，而且还要满足"正则"条件$af(n/b)\le cf(n)$。遇到的多项式界的函数中，多数都满足这个条件。
>
> 此外，这三种情况并非覆盖了$f(n)$的所有情况，$f(n)$可能小于$n^{\log_{b}a}$，但不是多项式意义上的小于，也有可能大于但不是多项式意义上的大于，这时候就**不能用主方法来求解，而是需要用递归树。**
>

### 举例说明

:one: $T(n)=9T(n/3)+n$

有$a=9,b=3,f(n)=n$,因此$n^{\log_{b}a}=n^{\log_{3}9}=\Theta(n^2)$，当我们取$\epsilon =1$,有$f(n)=O(n^{\log_{3}9-1})$，由定理一则有$T(n)=\Theta (n^2)$

:two: $T(n)=T(2n/3)+1$

有$a=1,b=3/2,f(n)=1$,因此$n^{\log_{b}a}=n^{\log_{3/2}1}=n^{0}=\Theta(1)$，由于$f(n)=\Theta(n^{\log_{b}a})=\Theta(1)$，由定理二则有$T(n)=\Theta (\lg n)$

:three: $T(n)=3T(n/4)+n\lg n$

有$a=3,b=4,f(n)=n\lg n$,因此$n^{\log_{b}a}=n^{\log_{4}3}=O(n^{0.793})$，由于$f(n)=\Omega(n^{\log_{4}3+\epsilon})$，其中$\epsilon \approx0.2$，因此如果可以证明正则条件成立，则可以使用定理三。当n足够大时，对于$c=3/4$，$af(n/b)=3（n/4)\lg{(n/4)}\le (3/4)n\lg n=cf(n)$，由定理二则有$T(n)=\Theta (n\lg n)$

:warning:主方法不适用于$T(n)+2T(n/2)+n\lg n$

有$a=2,b=2,f(n)=n\lg n$,因此$n^{\log_{b}a}=n$，$f(n)$虽然渐进大于n，但是并不是多项式意义上的的大于**(比值要是n的次方)**，对于任意的正常数$\epsilon$，比值$f(n)/n^{\log_{b}a}=\lg n$都渐进小于$n^\epsilon$，陷入了特殊情况，使用递归树可解决。

[参考资料]()

[计算机算法设计与分析（第五版）王晓东]()
[算法导论（第三版）]()
[西安交通大学算法设计课件 田暄]()