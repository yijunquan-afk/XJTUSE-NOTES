[TOC]

# ç¬¬ä¸‰è¯¾â€”â€”ç¥ç»ç½‘ç»œâ… 

## ç¥ç»ç½‘ç»œå¼•å…¥

### é€»è¾‘å›å½’çš„äºŒé˜¶æ®µè¡¨ç¤º

#### é€»è¾‘å›å½’

è¾“å…¥ä¸è¾“å‡ºä¹‹é—´çš„æ˜ å°„å…³ç³»å¦‚ä¸‹
$$
P(y=1|x;w,b)=\frac{1}{1+e^{-(w^Tx+b)}}
$$
å…¶ä¸­ï¼Œğ‘¥ä¸ºè¾“å…¥ç‰¹å¾ï¼Œğ‘¦ä¸ºè¾“å‡ºæ ‡è®°$y=\{0,1\}$ï¼ˆå³äºŒåˆ†ç±»ä»»åŠ¡ï¼‰ï¼Œğ’˜,ğ‘ä¸ºå­¦ä¹ å‚æ•°ã€‚

> ğ’˜æ˜¯æƒé‡ï¼Œbæ˜¯åå€¼bias

#### é€»è¾‘å›å½’çš„äºŒé˜¶æ®µè¡¨ç¤º

:one: **æ±‚å’Œ**summing function
$$
R^P\rightarrow R
$$

$$
z=w^Tx+b=w_1x_1+...+w_px_p+b
$$

:two: **æŒ¤å‹**sigmoid function
$$
R\rightarrow \{0,1\}
$$

$$
\hat y=P(y=1|x;w,b)=\frac{1}{1+e^{-z}}=\frac{e^{z}}{e^z+1}
$$

æŒ¤å‹å‡½æ•°å°±æ˜¯ä¹‹å‰é€»è¾‘å›å½’å­¦åˆ°çš„sigmoid functionï¼š

![image-20220319224232752](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319224232752.png)

<img src="https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319224911567.png" alt="image-20220319224911567" style="zoom:50%;"/>

### ç¥ç»å…ƒ

åœ¨ç”Ÿç‰©ç¥ç»ç½‘ç»œä¸­ï¼Œæ¯ä¸ªç¥ç»å…ƒä¸å…¶å®ƒç¥ç»å…ƒç›¸è¿ï¼Œå½“å®ƒâ€œå…´å¥‹â€æ—¶ï¼Œå‘å…¶å®ƒç¥ç»å…ƒå‘é€åŒ–å­¦ç‰©è´¨ã€‚

åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå°†ç”Ÿç‰©æ¨¡å‹æŠ½è±¡ä¸ºä¸‹å›¾æ‰€ç¤ºçš„ç®€å•ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚ç¥ç»å…ƒæ¥æ”¶æ¥è‡ªå…¶å®ƒç¥ç»å…ƒä¼ é€’è¿‡æ¥çš„è¾“å…¥ä¿¡å·ï¼Œè¾“å…¥ä¿¡å·é€šè¿‡å¸¦æƒé‡çš„è¿æ¥è¿›è¡Œä¼ é€’ï¼Œç„¶åé€šè¿‡<mark>â€œæ¿€æ´»å‡½æ•°â€</mark>äº§ç”Ÿç¥ç»å…ƒè¾“å‡º

<img src="https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319225112364.png" alt="image-20220319225112364" style="zoom:67%;"/>

**ç¥ç»å…ƒ**ï¼šä¸€ä¸ªç¥ç»å…ƒæ˜¯ç”±çº¿æ€§å˜æ¢å’Œéçº¿æ€§å˜æ¢å…±åŒæ„æˆçš„

å› æ­¤ï¼Œé€»è¾‘å›å½’æ˜¯åŒ…å«ä¸€ä¸ªç¥ç»å…ƒçš„ç¥ç»ç½‘ç»œ

![image-20220319230559000](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319230559000.png)

## ç¥ç»ç½‘ç»œ

ç¥ç»ç½‘ç»œåŒ…å«å¤šä¸ªç¥ç»å…ƒï¼Œè¾“å…¥ğ’™ä¸å¤šä¸ªç¥ç»å…ƒç›¸è¿ã€‚Wéœ€è¦ä»å‘é‡æ‰©å±•ä¸ºçŸ©é˜µã€‚

<mark>ğ‘Šğ‘–ğ‘—è¡¨ç¤ºçš„**å‘é‡xçš„ç¬¬ğ‘—ä¸ªå…ƒç´ ä¸å‘é‡ğ‘çš„ç¬¬ğ‘–ä¸ªå…ƒç´ ä¹‹é—´çš„è¿æ¥æƒé‡**</mark>

![image-20220319230903851](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319230903851.png)

å¯¹äºä¸Šå›¾çš„ç¥ç»ç½‘ç»œï¼ŒWå¦‚ä¸‹ï¼š

![image-20220319231013344](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319231013344.png)

### å…·æœ‰ä¸€ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œ

![image-20220319231727169](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319231727169.png)

æ„é€ ç‰¹å¾çš„ç‰¹å¾

<img src="https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319231811728.png" alt="image-20220319231811728" style="zoom:67%;"/>

h1æ˜¯éšè—å±‚çš„è¾“å‡º

### å…·æœ‰ä¸¤ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œ

![image-20220319232102321](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319232102321.png)

:one: å¤šå…ƒçº¿æ€§å›å½’ç›´æ¥å»ºç«‹äº†è¾“å…¥å’Œè¾“å‡ºçš„å…³ç³»

:two: é€»è¾‘å›å½’åˆ©ç”¨ä¸€ä¸ªsumming functionå’Œsigmoid functionå»ºç«‹äº†è¾“å…¥å’Œè¾“å‡ºçš„å…³ç³»

:three: ç¥ç»ç½‘ç»œåˆ©ç”¨äº†å¤šä¸ªsumming functionå’Œsigmoid functionå»ºç«‹äº†è¾“å…¥å’Œè¾“å‡ºçš„å…³ç³»

> ç¥ç»ç½‘ç»œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¤åˆå‡½æ•°
>
> è¿™é‡Œéƒ½æ˜¯å…¨è¿æ¥

### éçº¿æ€§æ¿€æ´»å‡½æ•°

å¼•å…¥éçº¿æ€§æ¿€æ´»å‡½æ•°çš„ç›®çš„æ˜¯å¾—åˆ°éçº¿æ€§å†³ç­–é¢

> ä¸è®ºç½‘ç»œå¤šæ·±ï¼Œçº¿æ€§æ¿€æ´»å‡½æ•°åªèƒ½è¾“å‡ºçº¿æ€§å†³ç­–é¢ï¼ˆè¾“å‡ºæ˜¯è¾“å…¥çš„çº¿æ€§å‡½æ•°ï¼‰ã€‚
>
> éçº¿æ€§æ¿€æ´»å‡½æ•°å¯ä»¥é€¼è¿‘ä»»æ„å¤æ‚å‡½æ•°ã€‚

<img src="https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319232757886.png" alt="image-20220319232757886" style="zoom:67%;"/>

<img src="https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220319233111998.png" alt="image-20220319233111998" style="zoom:80%;"/>

å½“$\hat y=\frac{1}{2}$æ˜¯æ— æ³•è¿›è¡Œåˆ¤æ–­çš„ï¼Œæ­¤æ—¶ä½¿ä¹‹æˆç«‹çš„è¾¹ç•Œç§°ä¸ºå†³ç­–é¢

**å¸¸ç”¨çš„éçº¿æ€§æ¿€æ´»å‡½æ•°**

| åå­—                                   | å›¾å½¢                                                         | æ–¹ç¨‹                                                         | å¯¼æ•°                                                         |
| -------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Binary step                            | ![image-20220320103516147](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320103516147.png) | ![image-20220320101646493](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320101646493.png) | ![image-20220320102547211](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320102547211.png) |
| <mark>Logistic(a.k.a Soft step)</mark> | ![Image for post](https://img-service.csdnimg.cn/img_convert/e8d11114ba5a984cb98dc2f35b127f18.png) | ![](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320102409148.png) | ![image-20220320102646642](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320102646642.png) |
| TanH                                   | ![Image for post](https://img-service.csdnimg.cn/img_convert/63bb680907c67f6791e6483c98ab06ba.png) | ![image-20220320102804371](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320102804371.png) | ![image-20220320102720150](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320102720150.png) |
| ReLU                                   | ![Image for post](https://img-service.csdnimg.cn/img_convert/a586e007d86138cadc28740d653063e1.png) | ![image-20220320102252623](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320102252623.png) | ![image-20220320102510609](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320102510609.png) |



Hidden layerï¼ˆéšå±‚ï¼‰çš„ä¸ªæ•°å¤§äº1çš„ç¥ç»ç½‘ç»œï¼Œç§°ä¸ºæ·±åº¦ç¥ç»ç½‘ç»œ

## è®­ç»ƒç¥ç»ç½‘ç»œ

### æŸå¤±å‡½æ•°

#### äºŒåˆ†ç±»æŸå¤±

é€»è¾‘å›å½’ä¸­ï¼Œä½¿ç”¨å¯¹æ•°ä¼¼ç„¶åº¦é‡æŸå¤±ï¼ˆæ¯ä¸ªæ ·æœ¬å±äºå…¶çœŸå®æ ‡è®°çš„æ¦‚ç‡è¶Šå¤§è¶Šå¥½ï¼‰

![image-20220320104901264](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320104901264.png)

<mark>äº¤å‰ç†µä»£ä»·å‡½æ•°cross entropy loss</mark>
$$
E=loss=-\log P(Y=\hat y|X=x)=-y\log(\hat y)-(1-y)\log(1-\hat y)
$$

> $y$æ˜¯çœŸå®è¾“å‡ºï¼Œ$\hat y$æ˜¯é¢„æµ‹è¾“å‡º
>
> $\hat y =f_\theta(x)=\frac{e^{wx+b}}{e^{wx+b}+1}$

æŸå¤±å‡½æ•°ä¸€å®šæ˜¯ä¸€ä¸ª**æ ‡é‡**

#### å¤šåˆ†ç±»æŸå¤±



![image-20220320110332270](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320110332270.png)

Softmaxå‡½æ•°ï¼šå°†å„ä¸ªè¾“å‡ºèŠ‚ç‚¹çš„è¾“å‡ºå€¼èŒƒå›´æ˜ å°„åˆ°[0,1]ï¼Œå¹¶ä¸”çº¦æŸå„ä¸ªè¾“å‡ºèŠ‚ç‚¹çš„è¾“å‡ºå€¼çš„å’Œä¸º1çš„å‡½æ•°

<mark>äº¤å‰ç†µä»£ä»·å‡½æ•°cross entropy loss</mark>
$$
E=loss=-\sum_{j=1,...,K}y_j\log\hat y_j
$$

> å…¶ä¸­$y_j$æ˜¯One-Hotå‘é‡ï¼šçœŸå®æ ‡ç­¾çš„ä½ç½®ä¸º1ï¼Œå…¶ä»–ä½ç½®ä¸º0
>
> One-Hotç¼–ç ï¼Œåˆç§°ä¸ºä¸€ä½æœ‰æ•ˆç¼–ç ï¼Œä¸»è¦æ˜¯é‡‡ç”¨Nä½çŠ¶æ€å¯„å­˜å™¨æ¥å¯¹Nä¸ªçŠ¶æ€è¿›è¡Œç¼–ç ï¼Œæ¯ä¸ªçŠ¶æ€éƒ½ç”±ä»–ç‹¬ç«‹çš„å¯„å­˜å™¨ä½ï¼Œå¹¶ä¸”åœ¨ä»»æ„æ—¶å€™åªæœ‰ä¸€ä½æœ‰æ•ˆã€‚

ä¾‹å¦‚ï¼Œå¯¹äº$y^T=(0 \ 1\ 0),\hat y^T=(\ 0.1\ 0.7\ 0.2)$ï¼Œå…¶æŸå¤±å‡½æ•°ä¸º$E=-(0\times \log0.1+1\times\log0.7+0\times\log0.2)=-\log 0.7$
$$
E=loss=\frac{1}{2}||y-\hat y^2||=\frac{1}{2}\sum^K_{j=1}(y_j-\hat y_j)^2
$$

#### å›å½’æŸå¤±

ä¸åˆ†ç±»ç½‘ç»œçš„ä¸åŒä¹‹å¤„ï¼šè¾“å‡ºå±‚ä¸å†åŒ…å«â€œSigmoidâ€å‡½æ•°

**ä½¿ç”¨äºŒæ¬¡ä»£ä»·å‡½æ•°**
$$
E=loss=\frac{1}{2}||y-\hat y^2||=\frac{1}{2}\sum^K_{j=1}(y_j-\hat y_j)^2
$$

### åå‘ä¼ æ’­

ç›®æ ‡ï¼šå¯»æ‰¾ä½¿æŸå¤±è¾¾åˆ°æœ€å°çš„ç¥ç»ç½‘ç»œæƒé‡

å¦‚ä½•å­¦ä¹ ç¥ç»ç½‘ç»œæƒé‡ğ‘Šğ¿ï¼Ÿä½¿ç”¨æ¢¯åº¦ä¸‹é™$W_L(t+1)=W_L(t)-\eta \frac{\partial E}{\partial W_L(t)}$

> å…¶ä¸­$\eta$ä¸ºå­¦ä¹ ç‡

å¦‚ä½•å¾—åˆ°ğ‘Š1,â€¦,ğ‘Šğ¿âˆ’1å±‚çš„æƒé‡ï¼Ÿä½¿ç”¨åå‘ä¼ æ’­Backpropagation

> é‡å¤åº”ç”¨å¾®ç§¯åˆ†çš„é“¾å¼æ³•åˆ™
>
> å±€éƒ¨æœ€å°åŒ–ç›®æ ‡å‡½æ•°
>
> è¦æ±‚ç½‘ç»œæ‰€æœ‰çš„â€œå—â€ï¼ˆblocksï¼‰éƒ½æ˜¯å¯å¾®çš„

#### æ•°å­¦ç¬¦å·è¯´æ˜

Hadamard (å“ˆè¾¾ç›)ä¹˜ç§¯/schur ä¹˜ç§¯ï¼š

å‡è®¾ğ‘ å’Œğ‘¡æ˜¯ä¸¤ä¸ªåŒæ ·ç»´åº¦çš„å‘é‡ï¼Œä½¿ç”¨ğ‘ âˆ˜ğ‘¡(æˆ–ğ‘ âŠ™ğ‘¡)æ¥è¡¨ç¤ºæŒ‰å…ƒç´ çš„ä¹˜ç§¯: (ğ‘ âŠ™ğ‘¡)ğ‘—= ğ‘ ğ‘—ğ‘¡ğ‘—
$$
\begin{bmatrix}
1\\2
\end{bmatrix}
\odot
\begin{bmatrix}
3\\4
\end{bmatrix}
=\begin{bmatrix}
1*3\\2*4
\end{bmatrix}=
\begin{bmatrix}
3\\8
\end{bmatrix}
$$

#### å›å½’ç¤ºä¾‹

å°±æ˜¯å¤åˆå‡½æ•°æ±‚åå¯¼

![image-20220320112945459](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320112945459.png)

å¯è§å·²ç»æ¯”è¾ƒå¤æ‚äº†

#### äºŒåˆ†ç±»ç¤ºä¾‹

åŒ…å«ä¸€ä¸ªéšå±‚çš„äºŒåˆ†ç±»ç¥ç»ç½‘ç»œï¼š

![image-20220320113413869](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320113413869.png)

**å¯¹w2çš„åå¯¼æ±‚è§£è¿˜æ¯”è¾ƒç®€å•**

![image-20220320113953437](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320113953437.png)

**å¯¹W1çš„åå¯¼å°±å¤æ‚å¾ˆå¤š**

<img src="https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320114345749.png" alt="image-20220320114345749" style="zoom:67%;"/>

<img src="https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320114904350.png" alt="image-20220320114904350" style="zoom:80%;" />

$w_{ij}^1$è¡¨ç¤ºè¾“å…¥ğ’™ çš„ç¬¬ğ‘—ä¸ªå…ƒç´ åˆ°ç¬¬1ä¸ªéšå±‚çš„ ç¬¬ ğ‘–ä¸ªç¥ç»å…ƒçš„æƒé‡

![image-20220320115125012](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320115125012.png)

é¦–å…ˆæ¨å¯¼å…³äºğ‘¾ğŸçš„ç¬¬ä¸€åˆ— $w_1^1$æ±‚å¯¼ç»“æœ,ç„¶åæ¨å¯¼åˆ°ç¬¬jåˆ—ï¼Œæœ€åå¾—åˆ°å…³äºè¿™ä¸ªçŸ©é˜µçš„åå¯¼

![image-20220320115629384](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320115629384.png)

## æ·±åº¦ç¥ç»ç½‘ç»œå­¦ä¹ 

![image-20220320115938109](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/qshell/image-20220320115938109.png)

**å‰å‘ä¼ æ’­åŠ åå‘ä¼ æ’­**

| ä¼ æ’­æ–¹å‘ | å‰å‘ä¼ æ’­                                           | åå‘ä¼ æ’­                                |
| -------- | -------------------------------------------------- | --------------------------------------- |
| æ­¥éª¤     | 1ã€ç»™å®šä¸€ä¸ªåˆå§‹çš„æƒé‡W                             | 1ã€è®¡ç®—è¯¯å·®æŸå¤±$E(y,\hat y)$            |
|          | 2ã€è¾“å…¥x                                           | 2ã€é€šè¿‡é“¾å¼æ³•åˆ™ï¼ˆå¤åˆå‡½æ•°æ±‚å¯¼ï¼‰è®¡ç®—æ¢¯åº¦ |
|          | 3ã€é€šè¿‡å¤åˆå‡½æ•°$\hat y=f_3(f_2(f_1(x)))$è®¡ç®—é¢„æµ‹å€¼ |                                         |
| æ›´æ–°å†…å®¹ | å·²çŸ¥è¾¹ï¼Œæ›´æ–°åœ†åœˆå†…å®¹                               | å·²çŸ¥åœ†åœˆå†…å®¹ï¼Œæ›´æ–°è¾¹ï¼ˆæƒé‡ï¼‰            |

é‡å¤è¿­ä»£å‰å‘å’Œåå‘æ­¥éª¤ï¼Œç›´è‡³ç®—æ³•æ”¶æ•›ã€‚

## å‚è€ƒèµ„æ–™

[1]åºå–„æ°‘.è¥¿å®‰äº¤é€šå¤§å­¦æœºå™¨å­¦ä¹ å¯¼è®º2022æ˜¥PPT

[2]å‘¨å¿—å.æœºå™¨å­¦ä¹ .åŒ—äº¬:æ¸…åå¤§å­¦å‡ºç‰ˆç¤¾,2016

[3\][Activation Functions in Neural Network](https://medium.com/swlh/activation-functions-in-neural-network-eb0ab4bb493)

