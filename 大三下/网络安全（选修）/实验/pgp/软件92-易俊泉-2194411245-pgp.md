# ç½‘ç»œå®‰å…¨ä¸ç®¡ç†â€”â€”pgpçš„ä½¿ç”¨

<center>è½¯ä»¶92-æ˜“ä¿Šæ³‰-2194411245</center>

## å®éªŒè¦æ±‚

â‘  ä»¥ä¸‰åˆ°å››äººä¸ºä¸€ç»„ï¼Œé€šè¿‡ä½¿ç”¨pgpè½¯ä»¶å®Œæˆå¯†é’¥çš„ç”Ÿæˆï¼Œå…¬é’¥çš„å…¬å¸ƒï¼Œåˆ©ç”¨pgpä¿æŠ¤æ•°æ®å¹¶ä¼ è¾“ï¼ŒéªŒè¯ç­¾åç­‰å·¥ä½œã€‚

â‘¡ è¿™é‡Œæˆ‘ä½¿ç”¨GnuPG

## å®éªŒåŸç†

### PGP

PGPï¼ˆè‹±è¯­ï¼šPretty Good Privacyï¼Œç›´è¯‘ï¼šä¼˜è‰¯ä¿å¯†åè®®ï¼‰æ˜¯ä¸€å¥—ç”¨äºè®¯æ¯åŠ å¯†ã€éªŒè¯çš„åº”ç”¨ç¨‹åºã€‚

PGPåŠ å¯†ç”±ä¸€ç³»åˆ—æ•£åˆ—ã€æ•°æ®å‹ç¼©ã€å¯¹ç§°å¯†é’¥åŠ å¯†ï¼Œä»¥åŠå…¬é’¥åŠ å¯†çš„ç®—æ³•ç»„åˆè€Œæˆã€‚æ¯ä¸ªæ­¥éª¤å‡æ”¯æŒå‡ ç§ç®—æ³•ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸€ä¸ªä½¿ç”¨ã€‚æ¯ä¸ªå…¬é’¥å‡ç»‘å®šä¸€ä¸ªç”¨æˆ·åå’Œ/æˆ–è€…E-mailåœ°å€ã€‚è¯¥ç³»ç»Ÿçš„æœ€åˆç‰ˆæœ¬é€šå¸¸ç§°ä¸ºå¯ä¿¡ç½‘æˆ–X.509ç³»ç»Ÿï¼›X.509ç³»ç»Ÿä½¿ç”¨çš„æ˜¯åŸºäºæ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„åˆ†å±‚æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆåæ¥è¢«åŠ å…¥åˆ°PGPçš„å®ç°ä¸­ã€‚å½“å‰çš„PGPåŠ å¯†ç‰ˆæœ¬é€šè¿‡ä¸€ä¸ªè‡ªåŠ¨å¯†é’¥ç®¡ç†æœåŠ¡å™¨æ¥è¿›è¡Œå¯†é’¥çš„å¯é å­˜æ”¾ã€‚

### GnuPG

GNU Privacy Guardï¼ˆGnuPG æˆ– GPGï¼‰æ˜¯ä¸€ä¸ªå¯†ç å­¦è½¯ä»¶ï¼Œç”¨äºåŠ å¯†ã€ç­¾åé€šä¿¡å†…å®¹åŠç®¡ç†éå¯¹ç§°å¯†ç å­¦çš„å¯†é’¥ã€‚GnuPG æ˜¯è‡ªç”±è½¯ä»¶ï¼Œéµå¾ª IETF è®¢å®šçš„ OpenPGP æŠ€æœ¯æ ‡å‡†è®¾è®¡ï¼Œå¹¶ä¸ PGP ä¿æŒå…¼å®¹ã€‚

GnuPG ä½¿ç”¨ç”¨æˆ·è‡ªè¡Œç”Ÿæˆçš„éå¯¹ç§°å¯†é’¥å¯¹æ¥åŠ å¯†ä¿¡æ¯ï¼Œç”±æ­¤äº§ç”Ÿçš„å…¬é’¥å¯ä»¥åŒå…¶ä»–ç”¨æˆ·ä»¥å„ç§æ–¹å¼äº¤æ¢ï¼Œå¦‚å¯†é’¥æœåŠ¡å™¨ã€‚ä»–ä»¬å¿…é¡»å°å¿ƒäº¤æ¢å¯†é’¥ï¼Œä»¥é˜²æ­¢å¾—åˆ°ä¼ªé€ çš„å¯†é’¥ã€‚GnuPG è¿˜å¯ä»¥å‘ä¿¡æ¯æ·»åŠ ä¸€ä¸ªæ•°å­—ç­¾åï¼Œè¿™æ ·ï¼Œæ”¶ä»¶äººå¯ä»¥éªŒè¯ä¿¡æ¯å®Œæ•´æ€§å’Œå‘ä»¶äººã€‚

GnuPG æ”¯æŒçš„å„ç§åŠ å¯†ç®—æ³•ï¼š

- å¯¹ç§°åŠ å¯†ï¼šCAST5ã€Camelliaã€Triple DESã€AESã€Blowfishã€Twofishã€ChaCha20ã€IDEA (ä» 1.4.13 å’Œ 2.0.20 å¼€å§‹è¢«æ·»åŠ )
- éå¯¹ç§°åŠ å¯†ï¼šElGamalã€RSAã€DSAã€ECDSAã€EdDSA
- å¯†ç æ•£åˆ—å‡½æ•°ï¼šRIPEMD-160ã€MD5ã€SHA-1ã€SHA-2ã€Tiger
- æ•°å­—ç­¾åï¼šDSAã€RSAã€ECDSAã€EdDSA

## å®éªŒæ­¥éª¤

### å®‰è£…GnuPG

![image-20220608010026378](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220608010026378.png)

### ç”Ÿæˆå¯†é’¥

#### åˆ›å»ºå¯†é’¥


```bash
root@VM-4-4-centos ~# gpg --gen-key 
gpg (GnuPG) 2.0.22; Copyright (C) 2013 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
```

#### é€‰æ‹©å¯†é’¥ç±»å‹
```bash
Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? 1
```

#### é€‰æ‹©å¯†é’¥æœ‰æ•ˆæ—¶é•¿
è¿™é‡Œæˆ‘é€‰æ‹©æ— é™æœŸ
```bash
Please specify how long the key should be valid.
         0 = key does not expire
      <n>  = key expires in n days
      <n>w = key expires in n weeks
      <n>m = key expires in n months
      <n>y = key expires in n years
Key is valid for? (0) 0
Key does not expire at all
Is this correct? (y/N) y
```
#### å¡«å†™ä¸ªäººä¿¡æ¯
```bash
GnuPG needs to construct a user ID to identify your key.

Real name: Yi Junquan
Email address: 2696974822@qq.com
Comment: software
You selected this USER-ID:
    "Yi Junquan (software) <2696974822@qq.com>"

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O


```
#### è®¾ç½®å¯†ç 

```
You need a Passphrase to protect your secret key.
```

![image-20220608010811719](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220608010811719.png)

#### ç”Ÿæˆå¯†é’¥

```bash
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
jsiasohfaosaojdoajdojajjajjjahhahsoasduoduaoudjldajldasjkdaskdiouoeiajksajWe need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: /root/.gnupg/trustdb.gpg: trustdb created
gpg: key 20424507 marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
pub   2048R/20424507 2022-06-07
      Key fingerprint = FC27 85F2 925C 096B 10A2  0CA9 F843 5EE8 2042 4507
uid                  Yi Junquan (software) <2696974822@qq.com>
sub   2048R/AA8CDF2E 2022-06-07

```

ä¸Šé¢çš„å­—ç¬¦ä¸²"20424507"ï¼Œè¿™æ˜¯"ç”¨æˆ·ID"çš„Hashå­—ç¬¦ä¸²ï¼Œå¯ä»¥ç”¨æ¥æ›¿ä»£"ç”¨æˆ·ID"ã€‚

### ç®¡ç†å¯†é’¥

#### åˆ—å‡ºå¯†é’¥

list-keyså‚æ•°åˆ—å‡ºç³»ç»Ÿä¸­å·²æœ‰çš„å¯†é’¥

```bash
root@VM-4-4-centos ~# ã€€gpg --list-keys
/root/.gnupg/pubring.gpg
------------------------
pub   2048R/20424507 2022-06-07
uid                  Yi Junquan (software) <2696974822@qq.com>
sub   2048R/AA8CDF2E 2022-06-07
```

ç¬¬ä¸€è¡Œæ˜¾ç¤ºå…¬é’¥æ–‡ä»¶åï¼ˆpubring.gpgï¼‰ï¼Œç¬¬äºŒè¡Œæ˜¾ç¤ºå…¬é’¥ç‰¹å¾ï¼ˆ2048ä½ï¼ŒHashå­—ç¬¦ä¸²å’Œç”Ÿæˆæ—¶é—´ï¼‰ï¼Œç¬¬ä¸‰è¡Œæ˜¾ç¤º"ç”¨æˆ·ID"ï¼Œç¬¬å››è¡Œæ˜¾ç¤ºç§é’¥ç‰¹å¾ã€‚

#### è¾“å‡ºå¯†é’¥

å…¬é’¥æ–‡ä»¶ï¼ˆ.gnupg/pubring.gpgï¼‰ä»¥äºŒè¿›åˆ¶å½¢å¼å‚¨å­˜ï¼Œarmorå‚æ•°å¯ä»¥å°†å…¶è½¬æ¢ä¸ºASCIIç æ˜¾ç¤ºã€‚

```bash
gpg --armor --output public-key.txt --export 20424507
```

"ç”¨æˆ·ID"æŒ‡å®šå“ªä¸ªç”¨æˆ·çš„å…¬é’¥ï¼Œoutputå‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼ˆpublic-key.txtï¼‰ã€‚

ç±»ä¼¼åœ°ï¼Œexport-secret-keyså‚æ•°å¯ä»¥è½¬æ¢ç§é’¥ã€‚

#### ä¸Šä¼ å…¬é’¥

å…¬é’¥æœåŠ¡å™¨æ˜¯ç½‘ç»œä¸Šä¸“é—¨å‚¨å­˜ç”¨æˆ·å…¬é’¥çš„æœåŠ¡å™¨ã€‚send-keyså‚æ•°å¯ä»¥å°†å…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚

```bash
root@VM-4-4-centos ~# gpg  --keyserver hkp://keyserver.ubuntu.com:80 --send-keys 20424507
gpg: sending key 20424507 to hkp server keyserver.ubuntu.com
```

åœ¨æœåŠ¡å™¨ä¸Šæœç´¢å…¬é’¥æ˜¯å¦ä¸Šä¼ æˆåŠŸï¼š

```bash
root@VM-4-4-centos ~# gpg --keyserver hkp://keyserver.ubuntu.com:80 --search-keys 2696974822@qq.com
gpg: searching for "2696974822@qq.com" from hkp server keyserver.ubuntu.com
(1)	Yi Junquan (software) <2696974822@qq.com>
	  2048 bit RSA key 20424507, created: 2022-06-07
Keys 1-1 of 1 for "2696974822@qq.com".  Enter number(s), N)ext, or Q)uit > q
```

å¯è§ä¸Šä¼ å…¬é’¥æˆåŠŸ

#### è·å–ä»–äººå…¬é’¥

è¿™é‡Œæˆ‘è·å–çš„æ˜¯å¾ç¤¼ç¥¯åŒå­¦çš„å…¬é’¥ï¼ˆæˆ‘ä¸ä»–ä»¥åŠæ¨å…†ç‘åŒå­¦åˆä½œå®Œæˆè¯¥å®éªŒï¼‰ã€‚

```
root@VM-4-4-centos ~# gpg --keyserver hkp://keyserver.ubuntu.com:80 --search-keys Corona09@163.com
gpg: searching for "Corona09@163.com" from hkp server keyserver.ubuntu.com
(1)	Corona X <Corona09@163.com>
	  2048 bit RSA key C282680C, created: 2022-06-07
Keys 1-1 of 1 for "Corona09@163.com".  Enter number(s), N)ext, or Q)uit > 1
gpg: requesting key C282680C from hkp server keyserver.ubuntu.com
gpg: key C282680C: public key "Corona X <Corona09@163.com>" imported
gpg: Total number processed: 1
gpg:               imported: 1  (RSA: 1)

```

### åŠ å¯†å’Œè§£å¯†

#### åŠ å¯†

encryptå‚æ•°ç”¨äºåŠ å¯†ã€‚`gpg --recipient [ç”¨æˆ·ID] --output demo.en.txt --encrypt demo.txt`

recipientå‚æ•°æŒ‡å®šæ¥æ”¶è€…çš„å…¬é’¥ï¼Œoutputå‚æ•°æŒ‡å®šåŠ å¯†åçš„æ–‡ä»¶åï¼Œencryptå‚æ•°æŒ‡å®šæºæ–‡ä»¶ã€‚è¿è¡Œä¸Šé¢çš„å‘½ä»¤åï¼Œdemo.en.txtå°±æ˜¯å·²åŠ å¯†çš„æ–‡ä»¶ï¼Œå¯ä»¥æŠŠå®ƒå‘ç»™å¯¹æ–¹ã€‚

```bash
root@VM-4-4-centos /tmp# gpg --recipient C282680C --output yjqencrypt.txt --encrypt yjqtest.txt 
gpg: 160789BF: There is no assurance this key belongs to the named user

pub  2048R/160789BF 2022-06-07 Corona X <Corona09@163.com>
 Primary key fingerprint: DC1B 2EBA D490 E664 F333  C433 77A6 5B9B C282 680C
      Subkey fingerprint: 6F25 A88F 9602 D8EE BE3E  5425 59E7 8A88 1607 89BF

It is NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes.

Use this key anyway? (y/N) y

```

æºæ–‡ä»¶å’ŒåŠ å¯†åçš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

```bash
root@VM-4-4-centos /tmp# cat yjqtest.txt 
ç¾å“‰å¾æ ¡ï¼ŒçœŸç†ä¹‹èŠ±ï¼Œé’å¹´ä¹‹æ¨¡æ¥·ï¼Œé‚¦å›½ä¹‹è£åï¼Œ
æ ¡æ——é£˜æ‰¬ï¼Œä¸æ—¥ä¿±é•¿ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ã€‚
ç¾å“‰å¾æ ¡ï¼Œé¼“èˆç¾¤ä¼¦ï¼Œå¯å‘æˆ‘ç¿æ™ºï¼Œæ¿€åŠ±æˆ‘çƒ­å¿±ï¼Œ
è‹±ä¿Šæµè·„ï¼Œç»è¥å››æ–¹ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ã€‚
ç¾å“‰å¾æ ¡ï¼Œæ€§çµæ³‰æºï¼Œç§‘å­¦ä¹‹å¥¥åºœï¼Œè‰ºæœ¯ä¹‹æ—å›­ï¼Œ
å®ä¸šæ‰©å¼ ï¼Œè¿›æ­¥æ— ç–†ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ã€‚
ç¾å“‰å¾æ ¡ï¼Œç¿çƒ‚æ–‡æ˜ï¼Œå®å­¦åŸ¹å›½æœ¬ï¼Œæ°‘æ—å¾—ä¸­å…´ï¼Œ
å®‡åœŸèŒ«èŒ«ï¼Œå±±é«˜æ°´é•¿ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ï¼Œä¸ºä¸–ç•Œä¹‹å…‰ã€‚
root@VM-4-4-centos /tmp# cat yjqencrypt.txt 
 
æ–ƒÔŒ6gÂ¼ò¹¯¤IYó¿¾¡u:ãª’<!;mq>Ù­F]BòŒ¹¨0@Â·>Âª8
               Ò¢#2Â­PBIgK%è†—69Ê·Ğ›
Ü¤á¡Šâ¬¸dWÂ¯8mÂ²è˜šeVLÒƒÌ·ğ¾±½Â°G1ò£Š£6×štxÂ£Â½ë¿¾{pi:Ã¿Â¸Ü´Ø˜Â¦.İ¨Â¡k2Â¿Â¥Ã¾İ€Ë×Â©Â¡Â« 
                                                Â¹${r9%ó…—“PÎ˜òŠ©–
                                                          PWÂ¹Ô¨Pİ‰É®Ã¾#ë®²ÏºÂ¨
                                                                      &ò»‹¸ÛšÂ¹Ä’1 
]ÇŒë£Ã¿"P*4ÕŠzÂ·                                                               GwÕ©ÂºÇ®GÂ¸Ü—Â¨DjçŠ»Ş§äº¨Â©ò” ¼Ñ¦ò†¢¨ÍŠÂ­Âªz/-$J}hÂ½'ó¿§¢DÂ´mĞ¾Û–z0Ôª2Ã¿*%Â«Ã¿S{Wó³‚‡Ø­DÎ`wÂ¬É =?Å”Ê—Âªğ•³
Ä®TÓ‡ZÂ§:Â¹Â½PÊƒ6Â¡Â§çª–JÜƒÂ­bió¿¾´`ñ¹‹¸Â©bO9"1Ñ¯+TÂ¿{Â¹Â¹Â¢(7Â¸mÂ­8Y"Â±                                                                                                                                                                  Â¹ÖœÓ“dn×™Â¸87SwÖ¶lÂ¢lã·^JÈ¥L'Â¸Ğ‡à·¤qÅ¦Ê½eMÂ­eÒ·)Vã³ªà¶œÑªÂ¸D(TI(â£“^
   Â¶Â°
Â¹Â´`Â¢
    $Â«ğš‚¿0G8S?|5Â« Ñ¨ÛVvÂ­â  
```



#### è§£å¯†

ç”±å¾ç¤¼ç¥¯åŒå­¦è§£å¯†åå¾—åˆ°

![image-20220608110155588](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220608110155588.png)

åŒæ—¶æˆ‘ä½¿ç”¨`gpg --decrypt mod.en.txt` è§£å¯†å¾ç¤¼ç¥¯åŒå­¦å‘æ¥çš„æ–‡ä»¶ã€‚

```bash
root@VM-4-4-centos /tmp# gpg --decrypt mod.en.txt 

You need a passphrase to unlock the secret key for
user: "Yi Junquan (software) <2696974822@qq.com>"
2048-bit RSA key, ID AA8CDF2E, created 2022-06-07 (main key ID 20424507)

gpg: encrypted with 2048-bit RSA key, ID AA8CDF2E, created 2022-06-07
      "Yi Junquan (software) <2696974822@qq.com>"
æ³‰ä½¬æˆ‘æ¦œ, è¥¿äº¤å¸Œæœ›; è½¯é™¢ä»£è¡¨, ä¸–ç•Œä¹‹å…‰.
__   __  _  ___    _____ ___  _     
\ \ / / | |/ _ \  |_   _/ _ \| |    
 \ V /  | | | | |   | || | | | |    
  | | |_| | |_| |   | || |_| | |___ 
  |_|\___/ \__\_\   |_| \__\_\_____|
```

### ç­¾å

#### ç­¾å

```
root@VM-4-4-centos /tmp# vim yjqsigntest.txt
root@VM-4-4-centos /tmp# gpg --sign yjqsigntest.txt 

You need a passphrase to unlock the secret key for
user: "Yi Junquan (software) <2696974822@qq.com>"
2048-bit RSA key, ID 20424507, created 2022-06-07

```

#### éªŒè¯ç­¾å

ç”±å¾ç¤¼ç¥¯åŒå­¦éªŒè¯ç­¾åå¾—åˆ°ï¼š

![image-20220608110432134](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/image-20220608110432134.png)



#### ç­¾å+åŠ å¯†

ã€€`gpg --local-user [å‘ä¿¡è€…ID] --recipient [æ¥æ”¶è€…ID] --armor --sign --encrypt demo.txt`

> local-userå‚æ•°æŒ‡å®šç”¨å‘ä¿¡è€…çš„ç§é’¥ç­¾åï¼Œrecipientå‚æ•°æŒ‡å®šç”¨æ¥æ”¶è€…çš„å…¬é’¥åŠ å¯†ï¼Œarmorå‚æ•°è¡¨ç¤ºé‡‡ç”¨ASCIIç å½¢å¼æ˜¾ç¤ºï¼Œsignå‚æ•°è¡¨ç¤ºéœ€è¦ç­¾åï¼Œencryptå‚æ•°è¡¨ç¤ºæŒ‡å®šæºæ–‡ä»¶ã€‚

```bash
root@VM-4-4-centos /tmp# ã€€gpg --local-user 20424507  --recipient  C282680C --armor --sign --encrypt yjqsignencrypt.txt

You need a passphrase to unlock the secret key for
user: "Yi Junquan (software) <2696974822@qq.com>"
2048-bit RSA key, ID 20424507, created 2022-06-07

gpg: 160789BF: There is no assurance this key belongs to the named user

pub  2048R/160789BF 2022-06-07 Corona X <Corona09@163.com>
 Primary key fingerprint: DC1B 2EBA D490 E664 F333  C433 77A6 5B9B C282 680C
      Subkey fingerprint: 6F25 A88F 9602 D8EE BE3E  5425 59E7 8A88 1607 89BF

It is NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes.

Use this key anyway? (y/N) y

```

![img](https://note-image-1307786938.cos.ap-beijing.myqcloud.com/typora/F42I[N$H%K]X81ND4B5_R{X.gif)

## å®éªŒç»“æœ

æˆåŠŸå®Œæˆå¯†é’¥çš„ç”Ÿæˆï¼Œå…¬é’¥çš„å…¬å¸ƒï¼Œåˆ©ç”¨pgpä¿æŠ¤æ•°æ®å¹¶ä¼ è¾“ï¼ŒéªŒè¯ç­¾åç­‰å·¥ä½œã€‚